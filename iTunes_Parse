package sax;

import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;
import javax.xml.parsers.ParserConfigurationException;

import org.xml.sax.Attributes;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;

import java.util.HashMap;

import java.io.IOException;

private void parseITunesXML() {

		/*get a factory*/
		SAXParserFactory spf = SAXParserFactory.newInstance();
		try 
		{
			//get a new instance of parser
			SAXParser sp = spf.newSAXParser();
			//parse the file and also register this class for call backs
			sp.parse("\\iTunes Library.xml", this);
		}
		catch(SAXException se) 
			{
				se.printStackTrace();
			}
		catch(ParserConfigurationException pce) 
			{
				pce.printStackTrace();
			}
		catch (IOException ie) 
			{
				ie.printStackTrace();
			}
	}
	
	/*Event Handlers*/
	public void startElement(String uri, String localName, String qName,
		Attributes attributes) throws SAXException {
		/*reset*/
		tempVal = "";
		if(qName.equalsIgnoreCase("Name")) {
			//create a new instance of track
			*tempEmp = new Track();
			*tempEmp.setType(attributes.getValue("type"));
		}
	}


	public void characters(char[] ch, int start, int length) throws SAXException {
		tempVal = new String(ch,start,length);
	}

	public void endElement(String uri, String localName,
		String qName) throws SAXException {

		if(qName.equalsIgnoreCase("Name")) 
		{
			/*add it to the list*/
			/**myEmpls.add(tempEmp);**/
		}
		else if (qName.equalsIgnoreCase("Artist")) 
		{
			tempEmp.setArtist(tempVal);
		}
		else if (qName.equalsIgnoreCase("Track Id")) 
		{
			tempEmp.setTrackId(Integer.parseInt(tempVal));
		}
		else if (qName.equalsIgnoreCase("Album")) 
		{
			tempEmp.setAlbum(Integer.parseInt(tempVal));
		}

	}
	
/* Print data for checks*/	
	private void printData(){

		System.out.println("No of Employees '" + myEmpls.size() + "'.");

		Iterator it = myEmpls.iterator();
		while(it.hasNext()) {
			System.out.println(it.next().toString());
		}
	}
	
/*Run the parser*/

public void run()
{
	parseITunesXML();
}
